@{
    Layout = null;
   
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Home</title>

    <!-- Bootstrap -->
    <link href="~/Content/responsive.css" rel="stylesheet" />
    <link href='@Url.Content("~/Scripts/src/jquery.contextMenu.css")' rel="stylesheet" />
    <link href='@Url.Content("~/Scripts/screen.css")' rel="stylesheet" />
    <link href='@Url.Content("~/Scripts/prettify/prettify.sunburst.css")' rel="stylesheet" />
    <link href='@Url.Content("~/Content/inner.css")' rel="stylesheet" />

    <link href='@Url.Content("~/Content/demo.css")' rel="stylesheet" />
    <link href='@Url.Content("~/Content/evol.colorpicker.min.css")' rel="stylesheet" />
    @*  <link href='@Url.Content("~/Content/jquery-ui.min.css")' rel="stylesheet" />*@
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <style>
        #filesTable > tbody > tr > td
        {
            cursor: pointer;
        }
    </style>
    <style>
        .must-have-class
        {
            background-color: orange;
        }

        #sortFixed thead tr
        {
            border-bottom: 1px solid #d6d6d6;
            cursor: n-resize;
        }

        #sortFixed tr
        {
            border-bottom: 1px solid #e6e6e6;
            cursor: n-resize;
        }

        .evo-cp-wrap
        {
            display: inline-block;
            width: 18px!important;
        }

        .evo-colorind
        {
            float: none!important;
            height: 20px;
        }

            .evo-colorind:after
            {
                display: none!important;
            }

        .font-collection
        {
            overflow: hidden;
            clear: both;
            vertical-align: middle;
            padding: 5px 11px;
        }

            .font-collection > span
            {
                float: left;
                width: auto;
                padding: 4px 6px;
            }

                .font-collection > span > a
                {
                    font-size: 17px;
                }

        /*#slideMainDiv {
            display: table;
        }*/

        #fileTitle
        {
            position: static!important;
            color: #000;
            line-height: 40px;
            margin: 0 300px;
            font-weight: 600;
            text-transform: capitalize;
            font-size: 22px;
        }

        .colorBar
        {
            margin-top: 20px;
            margin-left: 15px;
        }

        .swBar
        {
            margin-top: 74px;
            margin-left: -87px;
            width: 345px;
        }

        .ui-sortable > tr > td:last-child
        {
            position: relative!important;
            padding: 8px 8px;
            width:100%;
        }

        div[id^="clipText"]
        {
            min-height: 34px!important;
            height: auto!important;
        }

        .cliptextbox
        {
            border: thin solid #000000;            
            min-width: 290px;
            padding: 3px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="app-name">
            @*<h5><i class="fa fa-th"></i>@ViewBag.ApplicationName</h5>*@
            <a href="/Home/Preview">
                <img src="../../Images/vsl-logo.png" style="margin: 0 auto; display: block; width: 235px; z-index: 9999; position: relative;" />
            </a>
        </div>
        <div class="new-timeline">
            <p></p>
            <ul>
                <li><a href="/Home/Preview" id="preview"><span><i class="fa fa-th"></i></span>Preview</a></li>
                <li><a href="/Home/Themes" id="design"><span><i class="fa fa-wrench"></i></span>Design Setting</a></li>
                <li><a href="javascript:;" id="slides"><span><i class="fa fa-file-text-o"></i></span>Edit Slides</a></li>
                <li><a href="javascript:;" id="timeline"><span><i class="fa fa-microphone"></i></span>Timeline</a></li>
                <li><a href="javascript:;" id="publish"><span><i class="fa fa-check"></i></span>Publish</a></li>
            </ul>
        </div>
        @Html.Partial("_LoginPartial")
    </div>
    <div role="tabpanel">
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist" style="height: 40px; text-align: left;">
            <li role="presentation"><a href="#" id="fileAnchor" aria-controls="FILE" role="tab" class="tab-a">FILE</a></li>
            <li role="presentation" class="active"><a href="#HOME" aria-controls="HOME" role="tab" data-toggle="tab" class="tab-a">HOME</a></li>
            @*<li role="presentation"><a href="javascript:;" id="themeLi" aria-controls="Theme" class="tab-a">DashBoard</a></li>*@
            <li style="text-align: center; width: 78%;">
                <h5 id="fileTitle" data-file="@TempData["FileID"]">@ViewBag.fileName</h5>
            </li>
        </ul>
        <!-- Tab panes -->

        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="HOME">
                <ul class="pasteicn inline">

                    <li>
                        <div id="saveDiv" style="display: inline-block; margin-left: 5px; float: left;">
                            <button class="saveBtn" id="saveAnchor"><span class="saveNew"></span>&nbsp;save</button>
                        </div>
                        <div id="pasteDiv" class="disabled" style="display: inline-block; float: left;">
                            <span>
                                <button id="pasteAnchor" style="background-color: transparent; border: none;">
                                    <span class="Paste"></span>
                                    <br />
                                    <p style="text-align: center; font-size: 16px; font-weight: 600; margin: -5px 0px 0px 0px; line-height: 14px;">Paste</p>
                                </button>
                            </span>
                        </div>
                        <div id="copyDiv" style="display: inline-block; margin-left: 5px; float: left;">
                            <button id="copyAnchor" style="background-color: transparent; border: none;"><span class="copy"></span>&nbsp;Copy</button>
                        </div>
                        <div style="overflow: hidden; clear: both;"></div>
                        @*<p style="padding-top: 4px; font-size: 16px; font-weight: 600; line-height: 12px;">
                            Clipboard
                        </p>*@
                    </li>
                    <li>
                        <a href="#"><span class="ins-img"></span>
                            <input type="file" id="imageInputLink" class="fileInput" name="upload" accept="image/x-png, image/gif, image/jpeg" /></a>
                        <p style="text-align: center; font-size: 16px; font-weight: 600;">
                            Images
                        </p>
                    </li>
                    <li>
                        <div class="col-md-8">
                            <select id="fontfamilySelect" style="width: 207px; height: 26px; margin-top: 5px;">
                            </select>
                        </div>
                        <div class="col-md-4">
                            <select id="fontsizeSelect" style="width: 60px; height: 26px; margin-top: 5px;">
                            </select>
                        </div>
                        <div class="font-collection">
                            <span id="colorSpan" style="padding: 2px 4px; height: 20px; width: 20px; border: 1px solid black; margin-top: 5px; background-color: black;">

                                <a href="#" id="fontColorAnchor" onclick="ColorExpandThemes()">
                                    <i class="" style="color: #666; height: 20px; width: 20px;">&nbsp;</i></a>
                            </span>
                            @*<span>
                                <input id="cpButton" style="height: 10px; width: 10px; display: none" value="#000" />
                            </span>*@
                            <span>
                                <a href="#" id="boldAnchor"><i class="fa fa-bold" style="color: #666;"></i></a>
                            </span>
                            <span>
                                <a href="#" id="italicsAnchor"><i class="fa fa-italic" style="color: #666;"></i></a>
                            </span>
                            <span>
                                <a href="#" id="underlineAnchor"><i class="fa fa-underline" style="color: #666;"></i></a>
                            </span>
                            <span>
                                <a href="#" id="centerAnchor"><i class="fa fa-align-center" style="color: #838383; float: right;"></i></a>
                            </span>
                            <span>
                                <a href="#" id="leftAnchor"><i class="fa fa-align-left" style="color: #838383; float: right;"></i></a>
                            </span>
                            <span>
                                <a href="#" id="rightAnchor"><i class="fa fa-align-right" style="color: #838383; float: right;"></i></a>
                            </span>
                            <span>
                                <a href="#" id="justifyAnchor"><i class="fa fa-align-justify" style="color: #838383; float: right;"></i></a>
                            </span>
                        </div>
                        @*<p style="margin: -8px 0px 0px 0px; text-align: center; font-size: 14px;">Font</p>*@
                    </li>
                    @*<li>
                        
                        <p style="margin: 50px 0px 0px 0px; text-align: center; font-size: 14px;">
                            Paragraph
                        </p>
                    </li>*@
                   
                    <li id="h_bar" style=''>
                        <a href="#" style="color: #464646; font-weight: 600;" onclick='ExpandThemes()'>
                            <span class="theme"></span>
                            <p style="text-align: center; font-size: 16px; font-weight: 600;">
                                Themes
                            </p>
                        </a>

                    </li>
                    @* <li>
                        <span>
                            <a style="color: #464646; font-weight: 600;" href="#" id="addNewSlide">
                                <span class="new-slide"></span>
                                <span style="text-align: center; font-size: 16px; font-weight: 600; margin-top: 2px; display: inline-block;">New Slide</span>
                                <p style="text-align: center; font-size: 16px; font-weight: 600; margin: 0px 0px 0px 0px; line-height: 11px;">
                                    Slides
                                </p>
                            </a>
                        </span>
                    </li>*@
                    <li>
                        <span style="margin: 0 auto; display: block;">
                            <a href="#" id="addNewTextLink">
                                <span class="txtbox-txt"></span>
                            </a>
                        </span>
                        <span style="font-size: 16px; font-weight: 600; text-align: center; margin-top: 1px; display: block;">New</span>
                        <p style="text-align: center; font-size: 16px; font-weight: 600; margin: 0px 0px 0px 0px; line-height: 11px;">TextBox</p>
                    </li>
                    @*<li>
                        <a href="#" id="saveSlideTag">
                            <span class="videotag"></span>
                        </a>
                        <p style="text-align: center; font-size: 16px; font-weight: 600; margin: 4px 0px 0px 0px;">Video</p>
                    </li>*@
                    <li class="last-two" id="saveSlideTag">
                        <a><i class="fa fa-video-camera"></i>+Video</a>
                    </li>
                    <li class="last-two" id="addNewSlide">
                        <a href="javascript:;"><i class="fa fa-file-text-o"></i>+Slide</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="main-index-area">
        <div class="slides-area">
            <table id="slidePreviewTable" style="layout: table;">
                <tbody>
                </tbody>
            </table>
        </div>
        
        <div class="main-slide">
            <div id="slideMainDiv" class="contentright" style="background: transparent url('@ViewBag.theme') no-repeat; background-size: 100% 100%;">
            </div>
        </div>
    </div>
    <div id='sw_bar' class='swBar  UnifiedHeader' style='display: none; top: 30px;' onclick='CollapseThemes()'>
        <div style="height: 400px; overflow-y: scroll;">
            <ul id='sw_tileList' class='swTileList'>
            </ul>
            <span class='border-arrow arrow'></span>
            <span class='arrow'></span>
        </div>
    </div>
    <div id='sw_barBG' class='headerBarBG' onclick='CollapseThemes()'></div>
    <div id='color_bar' class='colorBar  UnifiedHeader' onclick='ColorExpandThemes()'>
        <ul id='color_tileList' class='colorTileList'>
        </ul>
        <span class='border-arrow arrow'></span>
        <span class='arrow'></span>
    </div>
    <div id='color_barBG' class='headerBarBG' onclick='ColorCollapseThemes()'></div>
    <div id="fileFucnDiv" class="left-menu-in" style="z-index: 999; position: inherit;">
        <div style="min-height: 100%;">
            <div class="side-col-menu">
                <a href="#" id="closefileFucnDiv">
                    <span class="left-arrow"></span>
                </a>
                <table id="recentWorkTable" class="hoverTable">
                    <tr data-attribute="New">
                        <td>
                            <p style="color: white;">
                                New
                            </p>
                        </td>
                    </tr>
                    <tr class="active" data-attribute="Open">
                        <td>
                            <p style="color: white;">Open</p>
                        </td>
                    </tr>
                    <tr data-attribute="Save">
                        <td>
                            <p style="color: white;">Save</p>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="side-white-doc">
                <div id="arialView">
                    <div>
                        <div>
                            <h2 style="color: black; border: 0; padding: 15px;">Open</h2>
                        </div>
                        <div>
                            <h3 style="color: black; border: 0; padding: 15px;">Recent Documents</h3>
                        </div>
                        <div style="padding-bottom: 50px;">
                            <table id="filesTable" class="fileTableStyle">
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div contenteditable="true">
        ggkafkdsjlkfsdlfl;sdklk;
    </div>
    <footer>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div id="notificationArea" style="text-align: center; color: white; text-transform: uppercase;"></div>
                </div>
            </div>
        </div>
    </footer>
    <div class="loader" id="loaderDiv" style="display: none; z-index: 99999999999; position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; min-height: 100%; background-color: rgba(0,0,0,.8);">
        <div class="underloader" style="background-color: #fff; height: 50px; width: 50px; position: absolute; left: 50%; top: 50%; text-align: center; border-radius: 50%;">
            <img src='@Url.Content("~/Images/ajax-loader.gif")' alt="" />
        </div>
    </div>
    @Scripts.Render("~/bundles/jquery")
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" type="text/javascript"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/html2canvas.js")'></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/src/jquery.ui.position.js")'></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/src/jquery.contextMenu.js")'></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/screen.js")'></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/prettify/prettify.js")'></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/evol.colorpicker.min.js")'></script>
    <script type="text/javascript" src='@Url.Content("~/Scripts/home.js")'></script>
    <script>
        $(document).ready(function () {
            $('.new-timeline li').removeClass('active');
            $('#slideshowDiv>.bx-wrapper').css({ 'max-width': '90%' });
            var timelineWidth = $('.new-timeline').width();
            $('.new-timeline>p').css({ 'width': timelineWidth });
            $('#slides').addClass('active');
            $('.main-index-area').css({ 'min-height': $(window).height() - 230 })
            $('#cpButton').colorpicker({ showOn: 'button' })
            .on('change.color', function (evt, color) {
                getFontColor(color);
            });

            //$('#headLinesDDl').on('change', function () {
            //    if ($('div[Id^=clipText]').hasClass('currentFocus')) {
            //        alert('focus');
            //        $('.currentFocus').append($('#headLinesDDl option:selected').text());
            //    }
            //    else if ($('div[Id^=clipText]').length > 1) {
            //        $('div[Id^=clipText]:last').append($('#headLinesDDl option:selected').text());
            //    }
            //    else
            //        $('div[Id^=clipText]:first').append($('#headLinesDDl option:selected').text());
            //});
            //$('#storyLinesDDl').on('change', function () {
            //    $('.currentFocus').append($('#storyLinesDDl option:selected').text());
            //});


        });
        var currentDivId = "";
        var caret = 0;

        function update(caller) {
            caret = getCaretPosition(caller);
            currentDivId = $(caller).attr('Id');
        }
        function getCaretPosition(editableDiv) {
            var caretPos = 0,
              sel, range;
            if (window.getSelection) {
                sel = window.getSelection();
                if (sel.rangeCount) {
                    range = sel.getRangeAt(0);
                    if (range.commonAncestorContainer.parentNode == editableDiv) {
                        caretPos = range.endOffset;
                    }
                }
            } else if (document.selection && document.selection.createRange) {
                range = document.selection.createRange();
                if (range.parentElement() == editableDiv) {
                    var tempEl = document.createElement("span");
                    editableDiv.insertBefore(tempEl, editableDiv.firstChild);
                    var tempRange = range.duplicate();
                    tempRange.moveToElementText(tempEl);
                    tempRange.setEndPoint("EndToEnd", range);
                    caretPos = tempRange.text.length;
                }
            }
            return caretPos;
        }
    </script>
    <script>
        $(document).ready(function () {
            Initialize();
            var timelineWidth = $('.new-timeline').width();
            $('.new-timeline>p').css({ 'width': timelineWidth });
            $('#slidePreviewTable tbody').sortable({
                items: '> tr',
                forcePlaceholderSize: true,
                placeholder: 'must-have-class',
                cancel: 'td:first',
                start: function (event, ui) {
                    // Build a placeholder cell that spans all the cells in the row
                    var cellCount = 0;
                    $('td, th', ui.helper).each(function () {
                        // For each TD or TH try and get it's colspan attribute, and add that or 1 to the total
                        var colspan = 1;
                        var colspanAttr = $(this).attr('colspan');
                        if (colspanAttr > 1) {
                            colspan = colspanAttr;
                        }
                        cellCount += colspan;
                    });
                    // Add the placeholder UI - note that this is the item's content, so TD rather thanTR
                    ui.placeholder.html('<td colspan="' + cellCount + '">&nbsp;</td>');
                },
                update: function () {
                    var count = 1;
                    //$('#slidePreviewTable tbody tr').each(function () {
                    //    $(this).children().eq(0).children().eq(0).text(count);
                    //    count++;
                    //});

                    window.previousSlideEditIndex = null;
                    var tempGlobalStyle = [];
                    var tempSlides = [];
                    var tempAnimation = [];
                    var DisplayOrder = [];
                    $('#slidePreviewTable tbody tr').each(function (i, item) {
                        $(this).children().eq(0).children().eq(0).text(count);
                        var disp = parseInt($(this).children().eq(0).children().eq(0).attr('defaultDispNo')) - 1;
                        tempGlobalStyle.push(window.globalStyle[disp]);
                        tempSlides.push(window.slides[disp]);
                        tempAnimation.push(window.animation[disp]);
                        DisplayOrder.push(i + 1);
                        $(this).children().eq(0).children().eq(0).attr('defaultDispNo', count);
                        count++;
                    });

                    window.globalStyle = tempGlobalStyle;
                    window.slides = tempSlides;
                    window.animation = tempAnimation;

                },
                end: function () {

                }
            }).disableSelection();
        });

        function Initialize() {
            currentDivId = "";
            var caret = 0;
            $('.cliptextbox').on("mousedown mouseup keydown keyup", function () {
                update(this);
            });
        }
    </script>
</body>
</html>
